# ML System Design Doc - [RU]
## Дизайн ML системы - ElectricityDesignAdvisor \<MVP\>

Проект по созданию рекомендательной системы для инженеров-проектировщиков ЛЭП

> ## Термины и определения
> - Пользователь - инженер-проектировщик, который работает CAD-системе (AutoCAD, nanoCAD и т.д.)
> - Деталь - элемент каталога, товар, составная часть опоры ЛЭП
> - Опора ЛЭП - сборочная единица, состоит из деталей
> - Типовой проект - сборник типовых опор ЛЭП

### 1. Цели и предпосылки

#### 1.1. Описание текущего бизнес-процесса
Инженер-проектировщик делает графическую часть проекта ЛЭП в программе AutoCAD, nanoCAD и т.п. следующим образом:
1. На палитре плагина SmartLine выбирает из типовых проектов опору и помещает её на чертеж
2. Если выбранная опора соответствует требованиям проекта, то оставляет всё как есть и переходит к следующей опоре
3. В примерно 30% случаев в среди типовых решений нет необходимой опоры, но есть похожая. Проектировщик выбирает её, а затем редактирует перечень её деталей. Детали выбирают из электронного каталога, встроенного в программу.

Каталог изделий, применяемых при проектировании и строительстве ЛЭП довольно обширный.
Поиск нужных деталей занимает длительное время.

Процесс поиска оптимального проектного решения - это итеративный процесс, нередко приходится менять одни детали на другие при изменении/уточнении тех. требований.

Решение какую деталь выбрать принимается проектировщиком.

#### 1.2. Зачем идем в разработку продукта?
Улучшение UX путем рекомендаций деталей позволит сократить время проектирования.
Это повысит лояльность пользователей к приложению, что обеспечит приток новых пользователей и удержание текущих.
В конечном итоге увеличится привлекательность приложения для рекламодателей.

#### 1.3. Польза от внедрения ML модели
Внедрение ML модели сократит время на выбор деталей из каталога и общую длительность проектирования ЛЭП,
снизит утомляемость и сократит количество ошибок.

#### 1.4. Предпосылки успешной реализации проекта
- Один из членов команды обладает экспертными знаниями в предметной области
- Есть доступ к исходному коду приложения SmartLine и его аудитории в 2000 пользователей для проведения экспериментов
- Малая цена ошибки рекомендательной системы, т.к. финальное решение о выборе детали остается за специалистом

#### 1.5. Что будем считать успехом итерации с точки зрения бизнеса
Среднее время выбора одной детали сократится с <span style="font-size: 11pt; color: goldenrod; font-weight:bold">32 секунд до 16 секунд</span>.
Пользователь выбирает деталь из рекомендации не менее чем в
<span style="font-size: 11pt; color: goldenrod; font-weight:bold">30% случаев</span>.

#### 1.6. Бизнес-требования и ограничения
Рекомендательная система для деталей должна ускорить удобство работы с программой.

Ограничения:  
Все пользователи работают в CAD-программе на локальном PC. Из них Порядка 20% не имеют доступа в интернет.
Плагин для проектирования SmartLine не имеет автообновления, т.к. запускается в одном домене с CAD.  
В связи с этим, любые изменения функционала SmartLine, как для сбора статистики, так и для тестирования рекомендательной системы происходят с существенной задержкой во времени. Требуется ручное обновление плагина со стороны пользователя, который не всегда в этом заинтересован.

Требуется к спецификации одной опоры (условной "корзине товаров") предложить до 25 сопутствующих деталей (товаров).  
Рекомендованные товары нужно выводить в UI в алфавитном порядке.

#### 1.7. Что входит в скоуп проекта/итерации, что не входит
Входит:
- MVP рекомендательной системы в виде отдельного веб-сервиса. 
- Доработка плагина SmartLine (сбор статистики, GUI для рекомендаций)
- Тестирование рекомендательной системы только на пользователях с доступом в интернет

Не входит:  
- Полное встраивание рекомендательной системы в десктопное приложение.


### 2. Методология
#### 2.1. Постановка задачи
С технической точки зрения будет реализовываться рекомендательная система.
#### 2.2. Этапы решения задачи
##### 2.2.1. Baseline
Шаг 1. Подготовка данных
- Выгрузка файла базы данных на локальную машину
- Определение категорий объектов для составления датасета
- Выбор признаков для построения модели
- Создание фреймов данных в Jupyter

Шаг 2. Предобработка данных
- Проверка данных на аномалии и пропуски, их последующая обработка
- Приведение к нужному типу
- Создание датасета для обучения

Шаг 3. Моделирование

Так как оценить качество предсказаний модели на этапе разработки не представляется возможным, метрикой качества будет являться экспертное мнение в данной предметной области
- Тестирование нескольких моделей
- Подбор параметров для модели

Шаг 4. Анализ результатов
- Генерирование нескольких предсказаний на основании вручную введенных признаков объектов.
- Оценка адекватности предсказаний экспертом
- Сравнение предсказаний модели с корзиной, составленной экспертом

Шаг 5. Тестирование работы модели на сервере
- Развертка модели
- Создание веб-интерфейса
- Проверка работоспособности всего пайплайна