## В ходе работы над бейзлайном выполнены следующие этапы:

### 1. Подготовка и обработка данных
- импортированы и объединены в один датафрейм данные из локального db-файла
- выполнено преобразование данных в соотвтетствии с согласованиями с заказчиком
- удалены дубликаты, типы данных приведены в соответсвие

### 2. Выбор и построение моделей  
Было рассмотрено два алгоритма:
- Модель NearestNeighbors со следующими параметрами n_neighbors=100, metric='cosine'
  * Из исходного датафрейма удалены ненужные столбцы, к категориальным признакам применен LabelEncoder, затем выполнена нормализация данных с помощью MinMaxScaler
- Алгоритм FP Growth
  * На основании имеющихся готовых корзин (типовые опоры ЛЭП) был создан список транзакций
  * рассчитана частота повторений каждого элемента в отдельности и их сочетаний друг с другом
  * сгенерированы ассоциативные правила для всех возможных сочетаний
- В соответствии с требованием заказчика, результатом работы модели является вывод до 25 деталей, наиболее релевантных тем деталям, которые выбрал пользователь
- Ответ модели проверяется на наличие дубликатов и очищается от повторяющихся элементов, находящихся как в самом запросе, так и в ответе.  
  
### 3. Реализация веб-интерфейса
#### 3.1 С помощью FastAPI реализован api-интерфейс для модели kNN
- Выполнены дампы для датафрейма, энкодера, скелера и модели
- Выполнен деплой приложения на удаленный сервер (развернуто окружение в miniconda c установкой дополнительных библиотек)
- Чтобы сымитировать реальный запрос пользователя, случайным образом сгенерирован список типовых опор ЛЭП, содержащий в себе набор деталей из ~10шт.
- Ответом на запрос является список рекомендованных деталей в количестве до 25шт  
- Интерфейс для тестирования модели kNNрасположен по адресу http://95.140.157.138:8000/docs#/default/request__get  
Для тестирования работы модели нужно нажать кнопку "Try it out", затем выбрать из списка группу деталей (опору ЛЭП), нажать Execute. Ниже на странице в окне Response body мы увидим список деталей, содержащихся в запросе и список рекомендованных деталей.
  
#### 3.2 С помощью Gradio реализован веб-интерфейс для алгоритма FP Growth
- Выполнены дампы для датафрейма, списка транзакций, и правил
- Выполнен деплой приложения на удаленный сервер (развернуто окружение в miniconda c установкой дополнительных библиотек)
- Чтобы сымитировать реальный запрос пользователя, случайным образом сгенерирован список типовых опор ЛЭП, содержащий в себе набор деталей из ~10шт.
- Ответом на запрос является список рекомендованных деталей в количестве до 25шт
- Интерфейс для тестирования модели kNNрасположен по адресу http://95.140.157.138:7777/  
Для тестирования работы модели нужно выбрать из списка группу деталей (опору ЛЭП), нажать Submit. В следующем окне будет показан список рекомендованных деталей.

### 4. Анализ и оценка результатов.
На основании экспертного мнения, результат работы модели kNN не является в достаточной степени удовлетворяющим требованиям заказчика.  
Алгоритм FP Growth справляется с задачей значительно лучше.  
Для первоначальной проверки качества модели разработана метрика, оценивающая покрытие рекомендациями недостающей части типовых корзин. Алгоритм работы метрики следующий:
1. Типовая корзина деталей делится на 3 фолда
2. 1 фолд подается в модель в качестве запроса
3. Список элементов в оставшихся 2-х фолдах от корзины сравнивается со списком рекомендаций, сгенерированных моделью
4. Количество совпадений делится на общее количество элементов в оставшихся 2-х фолдах
5. Далее в запрос подается следующий фолд, цикл повторяется
6. Значения метрики по всем фолдам усредняются.
  
Таким образом мы выясняем в какой степени рекомендации модели способны восстановить исходный набор деталей в типовой корзине.  
Был выполнен проход по всем типовым корзинам. Среднее значение метрики равно 0.82 - то есть по 1/3 от списка модель восстанавливает 82% от оставшихся 2/3 списка элементов.  
Учитывая мнение эксперта и значение метрики принято решение о дальнейшем использовании алгоритма FP Growth в работе.